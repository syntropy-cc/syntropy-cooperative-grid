# Syntropy Cooperative Grid CLI

Interface completa de linha de comando para gerenciar a Syntropy Cooperative Grid, incluindo setup do ambiente, gerenciamento de n√≥s, cria√ß√£o de USB boot√°vel, deploy de aplica√ß√µes e opera√ß√µes de rede cooperativa.

## üöÄ Instala√ß√£o

### Pr√©-requisitos

- Go 1.21 ou superior
- Sistema operacional: Linux, Windows ou WSL
- Permiss√µes de administrador (para opera√ß√µes USB)

### Compila√ß√£o

```bash
# Clonar o reposit√≥rio
git clone https://github.com/syntropy-cc/syntropy-cooperative-grid.git
cd syntropy-cooperative-grid/interfaces/cli

# Instalar depend√™ncias
make deps

# Compilar
make build
```

### Instala√ß√£o Global

```bash
# Instalar globalmente
make install

# Desinstalar
make uninstall
```

## ‚öôÔ∏è Setup Inicial

### Configurar Ambiente de Gerenciamento

```bash
# Setup completo do ambiente de gerenciamento
syntropy setup

# Verificar status do ambiente
syntropy manager health
```

## üñ•Ô∏è Comandos de Gerenciamento

### Listar e Conectar a N√≥s

```bash
# Listar todos os n√≥s gerenciados
syntropy manager list

# Conectar a um n√≥ espec√≠fico
syntropy manager connect node-01

# Status detalhado de um n√≥
syntropy manager status node-01

# Status de todos os n√≥s
syntropy manager status
```

### Descoberta de Rede

```bash
# Descobrir n√≥s na rede local
syntropy manager discover

# Descobrir em redes espec√≠ficas
syntropy manager discover --networks "192.168.1.0/24,10.0.0.0/24"

# Descoberta com configura√ß√µes customizadas
syntropy manager discover --port 2222 --timeout 15 --parallel 10
```

### Backup e Restore

```bash
# Backup completo das configura√ß√µes
syntropy manager backup

# Backup com arquivo espec√≠fico
syntropy manager backup --output /path/to/backup.tar.gz

# Restore de backup
syntropy manager restore backup_20240115_143022.tar.gz
```

## üìã Comandos de Templates

### Gerenciar Templates de Aplica√ß√£o

```bash
# Listar templates dispon√≠veis
syntropy templates list

# Mostrar detalhes de um template
syntropy templates show fortran-computation

# Deploy de template para um n√≥
syntropy templates deploy jupyter-lab --node node-01

# Deploy com valores customizados
syntropy templates deploy python-datascience --node node-01 --set "memory=2Gi" --set "cpu=1000m"

# Deploy em modo dry-run
syntropy templates deploy nginx --node node-01 --dry-run

# Criar novo template
syntropy templates create my-app --category web --description "My custom application"
```

## üì± Comandos USB

### Listar Dispositivos USB

```bash
# Listar em formato tabela
syntropy usb list

# Listar em formato JSON
syntropy usb list --format json

# Listar em formato YAML
syntropy usb list --format yaml
```

### Criar USB com Boot

```bash
# Criar USB com auto-detec√ß√£o
syntropy usb create --auto-detect --node-name "node-01"

# Criar USB especificando dispositivo
syntropy usb create /dev/sdb --node-name "node-01"

# Criar USB com coordenadas espec√≠ficas
syntropy usb create /dev/sdb --node-name "node-01" --coordinates "-23.5505,-46.6333"

# Criar USB usando chave de propriet√°rio existente
syntropy usb create /dev/sdb --node-name "node-02" --owner-key ~/.syntropy/keys/main.key

# Criar USB com descri√ß√£o personalizada
syntropy usb create /dev/sdb --node-name "node-03" --description "N√≥ de borda em S√£o Paulo"
```

### Formatar USB

```bash
# Formatar USB
syntropy usb format /dev/sdb

# Formatar USB com r√≥tulo personalizado
syntropy usb format /dev/sdb --label "MYUSB"

# Formatar USB sem confirma√ß√£o
syntropy usb format /dev/sdb --force
```

## üîß Comandos de N√≥s

### Listar N√≥s

```bash
# Listar todos os n√≥s
syntropy node list

# Listar n√≥s em formato JSON
syntropy node list --format json

# Filtrar n√≥s por status
syntropy node list --filter running
```

### Criar N√≥

```bash
# Criar n√≥ com USB
syntropy node create --usb /dev/sdb --name "node-01"

# Criar n√≥ com auto-detec√ß√£o
syntropy node create --auto-detect --name "node-02"

# Criar n√≥ com descri√ß√£o
syntropy node create --usb /dev/sdb --name "node-03" --description "N√≥ de produ√ß√£o"
```

### Gerenciar N√≥s

```bash
# Ver status do n√≥
syntropy node status node-01

# Atualizar configura√ß√£o
syntropy node update node-01 --name "node-01-updated"

# Reiniciar n√≥
syntropy node restart node-01

# Deletar n√≥
syntropy node delete node-01
```

## üê≥ Comandos de Containers

### Listar Containers

```bash
# Listar containers
syntropy container list

# Listar containers por n√≥
syntropy container list --node node-01
```

### Deploy de Containers

```bash
# Deploy de container simples
syntropy container deploy nginx --node node-01

# Deploy com configura√ß√µes personalizadas
syntropy container deploy nginx --node node-01 --port 8080:80 --env "ENV=production"

# Deploy com volume
syntropy container deploy postgres --node node-01 --volume "pgdata:/var/lib/postgresql/data"
```

### Gerenciar Containers

```bash
# Iniciar container
syntropy container start container-id

# Parar container
syntropy container stop container-id

# Reiniciar container
syntropy container restart container-id

# Ver logs
syntropy container logs container-id

# Remover container
syntropy container remove container-id
```

## üåê Comandos de Rede

### Gerenciar Mesh

```bash
# Habilitar mesh com criptografia
syntropy network mesh enable --encryption

# Desabilitar mesh
syntropy network mesh disable

# Ver status do mesh
syntropy network mesh status
```

### Gerenciar Rotas

```bash
# Listar rotas
syntropy network routes list

# Adicionar rota
syntropy network routes add --from node-01 --to node-02

# Remover rota
syntropy network routes remove route-id
```

### Topologia e Sa√∫de

```bash
# Ver topologia da rede
syntropy network topology

# Verificar sa√∫de da rede
syntropy network health

# Testar conectividade
syntropy network test --from node-01 --to node-02
```

## ü§ù Comandos Cooperativos

### Cr√©ditos

```bash
# Ver saldo de cr√©ditos
syntropy cooperative credits balance

# Ver hist√≥rico de transa√ß√µes
syntropy cooperative credits history

# Transferir cr√©ditos
syntropy cooperative credits transfer --to node-02 --amount 100
```

### Governan√ßa

```bash
# Listar propostas
syntropy cooperative governance proposals

# Votar em proposta
syntropy cooperative governance vote --proposal-id 123 --vote yes

# Ver resultados
syntropy cooperative governance results --proposal-id 123
```

### Reputa√ß√£o

```bash
# Ver reputa√ß√£o do n√≥
syntropy cooperative reputation show --node node-01

# Ver ranking de reputa√ß√£o
syntropy cooperative reputation ranking

# Ver hist√≥rico de reputa√ß√£o
syntropy cooperative reputation history --node node-01
```

## ‚öôÔ∏è Configura√ß√£o

### Arquivo de Configura√ß√£o

Crie um arquivo `config.yaml` em `~/.syntropy/`:

```yaml
# Configura√ß√µes globais
global:
  log_level: info
  cache_dir: ~/.syntropy/cache
  work_dir: /tmp/syntropy-work

# Configura√ß√µes de rede
network:
  default_encryption: true
  mesh_port: 443
  api_port: 8080

# Configura√ß√µes de USB
usb:
  default_label: "SYNTROPY"
  auto_confirm: false
  safety_checks: true

# Configura√ß√µes de n√≥s
nodes:
  default_ssh_port: 22
  default_user: syntropy
  key_size: 4096
```

### Vari√°veis de Ambiente

```bash
# N√≠vel de log
export SYNTROPY_LOG_LEVEL=debug

# Diret√≥rio de cache
export SYNTROPY_CACHE_DIR=/tmp/syntropy-cache

# Diret√≥rio de trabalho
export SYNTROPY_WORK_DIR=/tmp/syntropy-work

# Chave de propriet√°rio padr√£o
export SYNTROPY_OWNER_KEY=~/.syntropy/keys/main.key
```

## üîí Seguran√ßa

### Valida√ß√µes de Seguran√ßa

- ‚úÖ Verifica√ß√£o de discos do sistema
- ‚úÖ Confirma√ß√£o m√∫ltipla para opera√ß√µes destrutivas
- ‚úÖ Valida√ß√£o de tamanho e tipo de dispositivo
- ‚úÖ Gera√ß√£o segura de chaves SSH (RSA 4096-bit)
- ‚úÖ Configura√ß√£o autom√°tica de firewall

### Permiss√µes

```bash
# Adicionar usu√°rio ao grupo disk (Linux)
sudo usermod -aG disk $USER

# Adicionar usu√°rio ao grupo docker
sudo usermod -aG docker $USER

# Reiniciar sess√£o para aplicar grupos
newgrp disk
newgrp docker
```

## üêõ Solu√ß√£o de Problemas

### Problemas Comuns

**Erro: "dispositivo n√£o encontrado"**
```bash
# Verificar dispositivos dispon√≠veis
syntropy usb list

# Verificar permiss√µes
ls -la /dev/sd*
```

**Erro: "falha ao montar"**
```bash
# Verificar se dispositivo est√° em uso
sudo lsof /dev/sdb

# Desmontar manualmente
sudo umount /dev/sdb*
```

**Erro: "falha ao formatar"**
```bash
# Verificar se √© disco do sistema
syntropy usb list --format json | grep -i system

# Usar formata√ß√£o for√ßada
syntropy usb format /dev/sdb --force
```

### Logs

```bash
# Ver logs detalhados
syntropy --log-level debug usb create --auto-detect --node-name "node-01"

# Logs do sistema
journalctl -u syntropy -f
```

## ü§ù Contribui√ß√£o

### Desenvolvimento

```bash
# Fork do reposit√≥rio
git clone https://github.com/seu-usuario/syntropy-cooperative-grid.git

# Instalar depend√™ncias de desenvolvimento
make deps

# Executar testes
make test

# Verificar c√≥digo
make lint
make vet
```

### Estrutura do Projeto

```
interfaces/cli/
‚îú‚îÄ‚îÄ cmd/main.go                 # Ponto de entrada
‚îú‚îÄ‚îÄ internal/cli/               # Comandos CLI
‚îÇ   ‚îú‚îÄ‚îÄ root.go                 # Comando raiz
‚îÇ   ‚îú‚îÄ‚îÄ setup.go               # Setup do ambiente
‚îÇ   ‚îú‚îÄ‚îÄ manager.go             # Gerenciamento de n√≥s
‚îÇ   ‚îú‚îÄ‚îÄ templates.go           # Templates de aplica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ usb/usb.go             # Comandos USB
‚îÇ   ‚îú‚îÄ‚îÄ node.go                # Comandos de n√≥s
‚îÇ   ‚îú‚îÄ‚îÄ container.go           # Comandos de containers
‚îÇ   ‚îú‚îÄ‚îÄ network.go             # Comandos de rede
‚îÇ   ‚îî‚îÄ‚îÄ cooperative.go         # Comandos cooperativos
‚îú‚îÄ‚îÄ go.mod                     # Depend√™ncias Go
‚îú‚îÄ‚îÄ config.yaml                # Configura√ß√£o padr√£o
‚îú‚îÄ‚îÄ Makefile                   # Automa√ß√£o de build
‚îî‚îÄ‚îÄ README.md                  # Documenta√ß√£o
```

### Estrutura de Dados

Ap√≥s o setup, a CLI cria a seguinte estrutura em `~/.syntropy/`:

```
~/.syntropy/
‚îú‚îÄ‚îÄ nodes/                     # Metadados dos n√≥s
‚îÇ   ‚îú‚îÄ‚îÄ node-01.json          # Configura√ß√£o do n√≥
‚îÇ   ‚îî‚îÄ‚îÄ node-02.json
‚îú‚îÄ‚îÄ keys/                      # Chaves SSH
‚îÇ   ‚îú‚îÄ‚îÄ node-01_owner.key     # Chave privada
‚îÇ   ‚îú‚îÄ‚îÄ node-01_owner.key.pub # Chave p√∫blica
‚îÇ   ‚îî‚îÄ‚îÄ node-02_owner.key
‚îú‚îÄ‚îÄ config/                    # Configura√ß√£o do gerenciador
‚îÇ   ‚îú‚îÄ‚îÄ manager.json          # Configura√ß√£o principal
‚îÇ   ‚îú‚îÄ‚îÄ templates/            # Templates de aplica√ß√£o
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ applications/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ fortran-computation.yaml
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ python-datascience.yaml
‚îÇ   ‚îî‚îÄ‚îÄ logs/                 # Logs do sistema
‚îú‚îÄ‚îÄ cache/                     # Cache de descoberta
‚îú‚îÄ‚îÄ scripts/                   # Scripts auxiliares
‚îÇ   ‚îú‚îÄ‚îÄ discover-network.sh
‚îÇ   ‚îú‚îÄ‚îÄ backup-all-nodes.sh
‚îÇ   ‚îî‚îÄ‚îÄ health-check-all.sh
‚îî‚îÄ‚îÄ backups/                   # Backups das configura√ß√µes
    ‚îî‚îÄ‚îÄ backup_20240115_143022.tar.gz
```

## üìÑ Licen√ßa

Este projeto est√° licenciado sob a Licen√ßa MIT. Veja o arquivo `LICENSE` para mais detalhes.

## üÜò Suporte

- üìß Email: support@syntropy.coop
- üí¨ Discord: https://discord.gg/syntropy
- üìñ Documenta√ß√£o: https://docs.syntropy.coop
- üêõ Issues: https://github.com/syntropy-cc/syntropy-cooperative-grid/issues
